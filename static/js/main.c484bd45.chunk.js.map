{"version":3,"sources":["components/SearchInput.js","pages/Home.js","logo.svg","components/Chart.js","components/Product.js","Misc/TaxHelper.js","store/ProductMapper.js","store/Reducer.js","pages/SearchResults.js","pages/About.js","components/Footer.js","App.js","index.js"],"names":["SearchInput","big","useState","searchQuery","setSearchQuery","history","useHistory","className","onSubmit","e","preventDefault","trim","push","pathname","search","value","onChange","target","type","placeholder","Home","Chart","percent","rainbow","Rainbow","setSpectrum","formatPercentage","Math","round","viewBox","d","strokeDasharray","style","stroke","colorAt","x","y","Product","product","storeCut","systembolagetPercentageCut","systembolagetUnitCut","src","imgSrc","alt","name","subName","brand","category","volumeMl","alcoholPercent","id","originalPrice","toFixed","alcoholTax","vat","totalPrice","input","SKATTEVERKET_MELLANKLASS","getTaxLevel","taxLevelList","foundLevel","find","tax","alcFrom","alcTo","length","calcPerLiter","taxLevel","taxPerLiter","calculateTaxes","variables","categories","systembolaget","meta","skatteverketType","beer","skatteverket","taxPerPercentageAndLiter","calcPerPercentageAndLiter","wine","mellanklass","spirit","calcPerPureLiter","console","log","calculateTaxAndSystembolaget","isNonAlcoholic","some","c","nonAlcoholic","isSmallPackage","systembolagetType","cider","findSystembolagetType","mellanklassCategories","mc","findSkatteverketType","unitCuts","wineNonAlcoholic","beerAndCiderNonAlcoholic","wineSmall","calculateSystembolagetUnitCut","percentageCut","beforePercentageCut","calculateSystembolagetPercentageCut","getImageSource","rawProduct","images","imageUrl","initialState","loading","products","errorMessage","reducer","state","action","payload","map","index","productModel","productId","productNameBold","productNameThin","producerName","price","volume","alcoholPercentage","categoryLevel1","category2","categoryLevel2","category3","categoryLevel3","category4","categoryLevel4","ProductMapper","error","SearchResults","props","useLocation","useReducer","dispatch","parsed","queryString","parse","limit","setLimit","useEffect","axios","get","then","res","data","query","retrievedProducts","classname","spinner","slice","onClick","About","href","Footer","App","document","title","basename","process","path","exact","component","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.c484bd45.chunk.js","sourcesContent":["import React, { useState } from 'react'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nconst SearchInput = ({ big = true }) => {\r\n  const [searchQuery, setSearchQuery] = useState(\"\")\r\n  const history = useHistory();\r\n\r\n  const handleChange = (e) => {\r\n    setSearchQuery(e.target.value);\r\n  }\r\n\r\n  const resetInputField = () => {\r\n    setSearchQuery(\"\")\r\n  }\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (!searchQuery.trim()) return\r\n    history.push({\r\n      pathname: \"/search\",\r\n      search: \"?query=\" + searchQuery.trim()\r\n    });\r\n    resetInputField();\r\n  }\r\n\r\n\r\n  return (\r\n    <div className={big ? \"SearchWrap-big\" : \"SearchWrap\"}>\r\n      <form className=\"SearchForm\" onSubmit={handleSubmit}>\r\n        <input\r\n          className=\"SearchInput\"\r\n          value={searchQuery}\r\n          onChange={handleChange}\r\n          type=\"text\"\r\n          placeholder=\"Sök här efter alkodryck\"\r\n        />\r\n      </form>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default SearchInput;","import React from \"react\";\r\nimport SearchInput from \"../components/SearchInput\";\r\n\r\nfunction Home() {\r\n  return (\r\n    <div className=\"home-wrapper wrapper\">\r\n      <div className=\"welcome-text\">\r\n        <p>Välkommen</p>\r\n      </div>\r\n\r\n      <div>\r\n        <SearchInput />\r\n      </div>\r\n      <div className=\"welcome-info\">\r\n        <p>\r\n          Sök efter en alkodryck i Systembolagets sortiment för att se hur stor\r\n          andel av priset som är skatt\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n","export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import React from 'react'\r\nimport Rainbow from 'rainbowvis.js'\r\n\r\nexport const Chart = ({ percent }) => {\r\n    const rainbow = new Rainbow()\r\n    rainbow.setSpectrum(\"green\", \"yellow\", \"red\")\r\n\r\n    const formatPercentage = Math.round(percent * 100)\r\n\r\n    return (\r\n        <svg viewBox=\"0 0 36 36\" className=\"alko-chart\" key={formatPercentage}>\r\n            <path className=\"alko-circle-bg\"\r\n                d=\"M18 2.0845\r\n          a 15.9155 15.9155 0 0 1 0 31.831\r\n          a 15.9155 15.9155 0 0 1 0 -31.831\"\r\n            />\r\n            <path className=\"alko-circle\"\r\n                strokeDasharray={formatPercentage + \", 100\"}\r\n                style={{ stroke: rainbow.colorAt(formatPercentage) }}\r\n                d=\"M18 2.0845\r\n          a 15.9155 15.9155 0 0 1 0 31.831\r\n          a 15.9155 15.9155 0 0 1 0 -31.831\"\r\n            />\r\n            <text x=\"18\" y=\"20.35\" className=\"alko-percentage\">{formatPercentage}%</text>\r\n        </svg>\r\n    )\r\n}\r\n","import React from \"react\";\r\nimport { Chart } from \"./Chart\";\r\nimport \"../styles/Product.scss\";\r\n\r\nconst Product = ({ product }) => {\r\n  const storeCut =\r\n    product.systembolagetPercentageCut + product.systembolagetUnitCut;\r\n\r\n  return (\r\n    <div className=\"productCard\">\r\n      <div className=\"productImage\">\r\n        <img src={product.imgSrc} alt=\"NO IMAGE\" />\r\n      </div>\r\n      <div className=\"nameData\">\r\n        <p>\r\n          <b>{product.name}</b>\r\n        </p>\r\n        {product.subName ? <p>{product.subName}</p> : null}\r\n        {product.brand ? <p>{product.brand}</p> : null}\r\n        <div className=\"infoData\">\r\n          <p>{product.category}</p>\r\n          <p>{product.volumeMl / 10}cl</p>\r\n          <p>{product.alcoholPercent}%</p>\r\n          <p>Art.nr {product.id}</p>\r\n        </div>\r\n      </div>\r\n      <div className=\"priceData\">\r\n        <p>\r\n          <b>Inköp</b>\r\n        </p>\r\n        <p>\r\n          <b>{product.originalPrice.toFixed(2)}</b>\r\n        </p>\r\n        <p>Alkoholskatt</p>\r\n        <p>{product.alcoholTax.toFixed(2)}</p>\r\n        <p>Systembolagets påslag</p>\r\n        <p>{storeCut.toFixed(2)}</p>\r\n        <p>Moms</p>\r\n        <p>{product.vat}</p>\r\n        <p>\r\n          <b>Du betalar</b>\r\n        </p>\r\n        <p>\r\n          <b>{product.totalPrice}</b>\r\n        </p>\r\n      </div>\r\n      <div className=\"alkoChart\">\r\n        <Chart percent={1 - product.originalPrice / product.totalPrice} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Product;\r\n","/**************************************************************************************\r\n*    Title: Alkoholskatt\r\n*    Author: Borgström, J\r\n*    Date: 2021\r\n*    Code version: n/a\r\n*    Availability: http://www.herrborgstrom.se\r\n*\r\n***************************************************************************************/\r\n\r\nexport function round(input) {\r\n  return Math.round(input * 100) / 100;\r\n}\r\n\r\nconst SKATTEVERKET_MELLANKLASS = \"Mellanklassprodukt\";\r\n\r\nfunction findSystembolagetType(product, variables) {\r\n  const categories = variables.systembolaget.categories;\r\n  product.meta.isNonAlcoholic = product.categories.some((c) => c === categories.nonAlcoholic);\r\n  product.meta.isSmallPackage = product.volumeMl <= 350;\r\n\r\n  if (product.categories.find((c) => c === categories.beer)) {\r\n    product.meta.systembolagetType = categories.beer;\r\n  } else if (product.categories.find((c) => c === categories.wine)) {\r\n    product.meta.systembolagetType = categories.wine;\r\n  } else if (product.categories.find((c) => c === categories.spirit)) {\r\n    product.meta.systembolagetType = categories.spirit;\r\n  } else if (product.categories.find((c) => c === categories.cider)) {\r\n    product.meta.systembolagetType = categories.cider;\r\n  }\r\n}\r\n\r\nfunction findSkatteverketType(product, variables) {\r\n  const categories = variables.systembolaget.categories;\r\n  const mellanklassCategories = variables.systembolaget.mellanklassCategories;\r\n  if (product.categories.find((c) => mellanklassCategories.find((mc) => mc === c))) {\r\n    product.meta.skatteverketType = SKATTEVERKET_MELLANKLASS;\r\n  } else if (product.meta.systembolagetType === categories.cider) {\r\n    product.meta.skatteverketType = categories.wine;\r\n  } else {\r\n    product.meta.skatteverketType = product.meta.systembolagetType;\r\n  }\r\n}\r\n\r\nfunction getTaxLevel(product, taxLevelList) {\r\n  const foundLevel = taxLevelList.find((tax) => tax.alcFrom < product.alcoholPercent && tax.alcTo >= product.alcoholPercent);\r\n  if (!foundLevel) {\r\n    return taxLevelList[taxLevelList.length - 1];\r\n  }\r\n\r\n  return foundLevel;\r\n}\r\n\r\nfunction calcPerPercentageAndLiter(product, taxLevel) {\r\n  return round(product.alcoholPercent * taxLevel.taxPerPercentageAndLiter * (product.volumeMl / 1000));\r\n}\r\n\r\nfunction calcPerLiter(product, taxLevel) {\r\n  return round(taxLevel.taxPerLiter * (product.volumeMl / 1000));\r\n}\r\n\r\nfunction calcPerPureLiter(product, taxLevel) {\r\n  const pureAlcohol = ((product.alcoholPercent / 100) * product.volumeMl) / 1000;\r\n  return round(pureAlcohol * taxLevel.taxPerLiter);\r\n}\r\n\r\nfunction calculateTaxes(product, variables) {\r\n  const categories = variables.systembolaget.categories;\r\n  if (product.meta.skatteverketType === categories.beer) {\r\n    const taxLevel = getTaxLevel(product, variables.skatteverket.beer);\r\n    product.alcoholTax = calcPerPercentageAndLiter(product, taxLevel);\r\n  } else if (product.meta.skatteverketType === categories.wine) {\r\n    const taxLevel = getTaxLevel(product, variables.skatteverket.wine);\r\n    product.alcoholTax = calcPerLiter(product, taxLevel);\r\n  } else if (product.meta.skatteverketType === SKATTEVERKET_MELLANKLASS) {\r\n    const taxLevel = getTaxLevel(product, variables.skatteverket.mellanklass);\r\n    product.alcoholTax = calcPerLiter(product, taxLevel);\r\n  } else if (product.meta.skatteverketType === categories.spirit) {\r\n    const taxLevel = getTaxLevel(product, variables.skatteverket.spirit);\r\n    product.alcoholTax = calcPerPureLiter(product, taxLevel);\r\n  } else {\r\n    product.alcoholTax = 0;\r\n    console.log(\"Could not calculate taxes\", product.name);\r\n  }\r\n}\r\n\r\nfunction calculateSystembolagetUnitCut(product, variables) {\r\n  const categories = variables.systembolaget.categories;\r\n  const unitCuts = variables.systembolaget.unitCuts;\r\n  if (product.meta.isNonAlcoholic) {\r\n    if (product.meta.systembolagetType === categories.wine) {\r\n      product.systembolagetUnitCut = unitCuts.wineNonAlcoholic;\r\n    } else if (product.meta.systembolagetType === categories.cider ||\r\n      product.meta.systembolagetType === categories.beer) {\r\n      product.systembolagetUnitCut = unitCuts.beerAndCiderNonAlcoholic;\r\n    } else {\r\n      product.systembolagetUnitCut = 0;\r\n      console.log(\"Could not calculate unit cut\", product.name);\r\n    }\r\n  } else if (product.meta.systembolagetType === categories.wine) {\r\n    product.systembolagetUnitCut = product.meta.isSmallPackage ? unitCuts.wineSmall : unitCuts.wine;\r\n  } else if (product.meta.systembolagetType === categories.beer) {\r\n    product.systembolagetUnitCut = unitCuts.beer;\r\n  } else if (product.meta.systembolagetType === categories.cider) {\r\n    product.systembolagetUnitCut = unitCuts.cider;\r\n  } else if (product.meta.systembolagetType === categories.spirit) {\r\n    product.systembolagetUnitCut = unitCuts.spirit;\r\n  } else {\r\n    product.systembolagetUnitCut = 0;\r\n    console.log(\"Could not calculate unit cut\", product.name);\r\n  }\r\n}\r\n\r\nfunction calculateSystembolagetPercentageCut(product, variables) {\r\n  const percentageCut = variables.systembolaget.percentageCut;\r\n  const priceBefore = product.totalPrice - product.vat - product.systembolagetUnitCut - product.alcoholTax;\r\n  const beforePercentageCut = priceBefore / (1 + percentageCut);\r\n  product.systembolagetPercentageCut = round(beforePercentageCut * percentageCut);\r\n}\r\n\r\nexport function calculateTaxAndSystembolaget(product, variables) {\r\n  product.meta = product.meta || {};\r\n  product.vat = round(product.totalPrice * .2);\r\n\r\n  findSystembolagetType(product, variables);\r\n  findSkatteverketType(product, variables);\r\n\r\n  calculateTaxes(product, variables);\r\n  calculateSystembolagetUnitCut(product, variables);\r\n  calculateSystembolagetPercentageCut(product, variables);\r\n  product.originalPrice = product.totalPrice - product.vat - product.systembolagetPercentageCut - product.systembolagetUnitCut - product.alcoholTax;\r\n}","import { calculateTaxAndSystembolaget } from \"../Misc/TaxHelper\";\r\n\r\nfunction getImageSource(rawProduct) {\r\n  const hasImage = rawProduct?.images?.length > 0;\r\n  if (hasImage) return rawProduct.images[0].imageUrl + \"_200.png\";\r\n}\r\n\r\n// eslint-disable-next-line import/no-anonymous-default-export\r\nexport default function (rawProduct, index, variables) {\r\n  const productModel = {\r\n    id: rawProduct.productId,\r\n    name: rawProduct.productNameBold,\r\n    subName: rawProduct.productNameThin,\r\n    brand: rawProduct.producerName,\r\n    totalPrice: rawProduct.price,\r\n    volumeMl: rawProduct.volume,\r\n    alcoholPercent: rawProduct.alcoholPercentage,\r\n    category: rawProduct.categoryLevel1,\r\n    category2: rawProduct.categoryLevel2,\r\n    category3: rawProduct.categoryLevel3,\r\n    category4: rawProduct.categoryLevel4,\r\n    categories: [\r\n      rawProduct.categoryLevel1,\r\n      rawProduct.categoryLevel2,\r\n      rawProduct.categoryLevel3,\r\n      rawProduct.categoryLevel4,\r\n    ],\r\n    imgSrc: getImageSource(rawProduct),\r\n  };\r\n\r\n  calculateTaxAndSystembolaget(productModel, variables);\r\n\r\n  return productModel;\r\n}\r\n","import ProductMapper from \"./ProductMapper\";\r\n\r\nexport const initialState = {\r\n    loading: false,\r\n    products: [],\r\n    errorMessage: null,\r\n    variables: []\r\n};\r\n\r\nexport const reducer = (state, action) => {\r\n    switch (action.type) {\r\n        case \"SEARCH_REQUEST\":\r\n            return {\r\n                ...state,\r\n                loading: true,\r\n                errorMessage: null\r\n            };\r\n        case \"SEARCH_SUCCESS\":\r\n            return {\r\n                ...state,\r\n                loading: false,\r\n                products: action.payload.map((product, index) => ProductMapper(product, index, state.variables))\r\n            };\r\n        case \"SEARCH_FAIL\":\r\n            return {\r\n                ...state,\r\n                loading: false,\r\n                errorMessage: action.error\r\n            }\r\n        case \"SET_VAR\":\r\n            return {\r\n                ...state,\r\n                variables: action.payload\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}","import React, { useEffect, useReducer, useState } from \"react\";\r\nimport queryString from \"query-string\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport spinner from \"../logo.svg\";\r\nimport Product from \"../components/Product\";\r\nimport { initialState, reducer } from \"../store/Reducer\";\r\nimport SearchInput from \"../components/SearchInput\";\r\nimport \"../styles/searchResults.scss\";\r\n\r\nconst URL = \"https://skatt.herrborgstrom.se/products/\";\r\nconst VAR = \"https://skatt.herrborgstrom.se/variables\";\r\n\r\nconst SearchResults = (props) => {\r\n  const { search } = useLocation();\r\n  const [state, dispatch] = useReducer(reducer, initialState);\r\n  const parsed = queryString.parse(search);\r\n  const [limit, setLimit] = useState(10);\r\n\r\n  useEffect(() => {\r\n    axios.get(VAR).then((res) => {\r\n      dispatch({\r\n        type: \"SET_VAR\",\r\n        payload: res.data,\r\n      });\r\n      console.log(res);\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setLimit(products.length > 10 ? products.length : 10);\r\n    axios.get(URL + parsed.query).then((res) => {\r\n      dispatch({\r\n        type: \"SEARCH_SUCCESS\",\r\n        payload: res.data.products,\r\n      });\r\n    });\r\n  }, [search]);\r\n\r\n  const { products, errorMessage, loading } = state;\r\n\r\n  const retrievedProducts =\r\n    loading && !errorMessage ? (\r\n      <img classname=\"spinner\" src={spinner} alt=\"\" />\r\n    ) : errorMessage ? (\r\n      <div className=\"errorMessage\">{errorMessage}</div>\r\n    ) : (\r\n      products\r\n        .slice(0, limit ? limit : products.length)\r\n        .map((product, index) => <Product key={index} product={product} />)\r\n    );\r\n\r\n  return (\r\n    <div className=\"searchResults-wrapper wrapper\">\r\n      <SearchInput big={false} />\r\n      <div className=\"SearchResults\">\r\n        <div className=\"product-wrap\">{retrievedProducts}</div>\r\n      </div>\r\n      <div\r\n        className=\"ShowMoreResults\"\r\n        onClick={() =>\r\n          setLimit(limit + 10 < products.length ? limit + 10 : products.length)\r\n        }\r\n      >\r\n        <p>\r\n          Visar {limit ? limit : products.length} av {products.length} totalt\r\n        </p>\r\n        <p>Klicka för att visa mer, eller förfina sökningen</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchResults;\r\n","import React from \"react\";\r\nimport SearchInput from \"../components/SearchInput\";\r\n\r\nconst About = () => {\r\n  return (\r\n    <div className=\"wrapper\">\r\n      <SearchInput big={false} />\r\n      <div className=\"about-wrapper\">\r\n        <p>\r\n          <b>Varför?</b>\r\n        </p>\r\n        <li>\r\n          Sidan är skapad i syfte att lära mig React då jag sedan tidigare\r\n          endast programmerat i Vue och vanilla Javascript\r\n        </li>\r\n        <p>\r\n          <b>Hur?</b>\r\n        </p>\r\n        <li>\r\n          Idé tagen från min goda vän{\" \"}\r\n          <a href=\"https://.herrborgstrom.se\">Joakim Borgström</a>\r\n        </li>{\" \"}\r\n        <li>\r\n          För att lära dig hur den fungerar hänvisar jag till Borgströms\r\n          ursprungliga version skriven i Vue på{\" \"}\r\n          <a href=\"https://skatt.herrborgstrom.se/about\">Alkoholskatt</a>\r\n        </li>\r\n        <li>Jag har skrivit all kod själv bortsett från uträkningarna av</li>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default About;\r\n","import React from 'react'\r\n\r\nconst Footer = () => {\r\n    return (\r\n        <div className=\"footer\">\r\n            <p><a href=\"/\">Home</a></p>\r\n            <p><a href=\"/about\">About</a></p>\r\n            <p>Skapad av Johan Berglund</p>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Footer;","import \"./App.scss\";\r\nimport Home from \"./pages/Home\";\r\nimport SearchResults from \"./pages/SearchResults\";\r\nimport About from \"./pages/About\";\r\nimport Footer from \"./components/Footer\";\r\n\r\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\r\n\r\nfunction App() {\r\n  document.title = \"Spritmonopolet\";\r\n  return (\r\n    <Router basename={process.env.PUBLIC_URL}>\r\n      <Route path=\"/\" exact component={Home} />\r\n      <Route path=\"/search\" component={SearchResults} />\r\n      <Route path=\"/about\" exact component={About} />\r\n      <Footer />\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport { HashRouter } from \"react-router-dom\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n      <App />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}